
# Permission System API

–ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∫–æ–Ω—Ç—Ä–æ–ª—è –¥–æ—Å—Ç—É–ø–∞ –Ω–∞ –±–∞–∑–µ FastAPI —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π RBAC, ABAC, 
–≤–ª–∞–¥–µ–Ω–∏—è —Ä–µ—Å—É—Ä—Å–∞–º–∏ –∏ –ø–æ–ª–Ω—ã–º –∞—É–¥–∏—Ç–æ–º.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üîê JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —Å blacklist —Ç–æ–∫–µ–Ω–æ–≤
- üë• –†–æ–ª–∏ —Å –∏–µ—Ä–∞—Ä—Ö–∏–µ–π –∏ –Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ–º
- üìÅ –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ —Ä–µ—Å—É—Ä—Å—ã —Å –≤–ª–∞–¥–µ–Ω–∏–µ–º
- ‚úÖ –ì—Ä–∞–Ω—É–ª—è—Ä–Ω—ã–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è (–¥–µ–π—Å—Ç–≤–∏–µ + –æ–±–ª–∞—Å—Ç—å)
- ü§ù –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–µ —Ä–∞—Å—à–∞—Ä–∏–≤–∞–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞
- ‚è∞ –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –∏—Å—Ç–µ—á–µ–Ω–∏–µ–º
- üìä –ü–æ–ª–Ω—ã–π –∞—É–¥–∏—Ç –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π
- üè¢ –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–æ–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (–æ—Ç–¥–µ–ª—ã)

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
2. –°–æ–∑–¥–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ:
```bash
python -m venv venv
source venv/bin/activate  # Linux/Mac
venv\Scripts\activate     # Windows
```

3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```bash
pip install -r requirements.txt
```

4. –°–æ–∑–¥–∞—Ç—å .env —Ñ–∞–π–ª (—Å–º. –ø—Ä–∏–º–µ—Ä –≤—ã—à–µ)

5. –ó–∞–ø—É—Å—Ç–∏—Ç—å Redis:
```bash
docker run -d -p 6379:6379 redis:alpine –∏–ª–∏ docker compose up -d 
```

6. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:
```bash
python -m src.main
```

API –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –Ω–∞ http://localhost:8000
–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: http://localhost:8000/docs

## –¢–µ—Å—Ç–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏

–ü–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ —Å–æ–∑–¥–∞—é—Ç—Å—è —Ç–µ—Å—Ç–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏:

| Email                  | Password   | Role    | Department |
|------------------------|------------|---------|------------|
| admin@example.com      | admin123   | Admin   | IT         |
| manager@example.com    | manager123 | Manager | IT         |
| user@example.com       | user123    | User    | IT         |
| viewer@example.com     | viewer123  | Viewer  | HR         |

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π

### –¢–∏–ø—ã –¥–µ–π—Å—Ç–≤–∏–π (ActionType)
- `CREATE` - —Å–æ–∑–¥–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
- `READ` - —á—Ç–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
- `UPDATE` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
- `DELETE` - —É–¥–∞–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
- `EXECUTE` - –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- `SHARE` - —Ä–∞—Å—à–∞—Ä–∏–≤–∞–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞

### –û–±–ª–∞—Å—Ç–∏ –¥–µ–π—Å—Ç–≤–∏—è (PermissionScope)
- `OWN` - —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ —Ä–µ—Å—É—Ä—Å—ã
- `DEPARTMENT` - —Ä–µ—Å—É—Ä—Å—ã —Å–≤–æ–µ–≥–æ –æ—Ç–¥–µ–ª–∞
- `ALL` - –≤—Å–µ —Ä–µ—Å—É—Ä—Å—ã

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π

1. **–°—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å** - –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø
2. **–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è** - –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è—é—Ç –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω–æ–µ
3. **–í–ª–∞–¥–µ–Ω–∏–µ** - –≤–ª–∞–¥–µ–ª–µ—Ü –∏–º–µ–µ—Ç –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø
4. **–ü—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø** - –ø—É–±–ª–∏—á–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã (—Ç–æ–ª—å–∫–æ READ)
5. **–†–æ–ª–µ–≤—ã–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è** - —á–µ—Ä–µ–∑ —Ä–æ–ª–∏ —Å —É—á–µ—Ç–æ–º scope
6. **–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é** - –æ—Ç–∫–∞–∑

## API Endpoints

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- `POST /auth/register` - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
- `POST /auth/login` - –í—Ö–æ–¥
- `POST /auth/logout` - –í—ã—Ö–æ–¥
- `GET /auth/me` - –¢–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
- `POST /auth/refresh` - –û–±–Ω–æ–≤–∏—Ç—å —Ç–æ–∫–µ–Ω

### –†–µ—Å—É—Ä—Å—ã
- `GET /resources` - –°–ø–∏—Å–æ–∫ —Ä–µ—Å—É—Ä—Å–æ–≤
- `GET /resources/{id}` - –ü–æ–ª—É—á–∏—Ç—å —Ä–µ—Å—É—Ä—Å
- `POST /resources` - –°–æ–∑–¥–∞—Ç—å —Ä–µ—Å—É—Ä—Å
- `PUT /resources/{id}` - –û–±–Ω–æ–≤–∏—Ç—å —Ä–µ—Å—É—Ä—Å
- `DELETE /resources/{id}` - –£–¥–∞–ª–∏—Ç—å —Ä–µ—Å—É—Ä—Å (soft)
- `GET /resources/categories` - –°–ø–∏—Å–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –í—Ö–æ–¥ –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞
```bash
curl -X POST "http://localhost:8000/auth/login" \
  -H "Content-Type: application/json" \
  -d '{"email":"user@example.com","password":"user123"}'
```

### –°–æ–∑–¥–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞
```bash
curl -X POST "http://localhost:8000/resources" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "title": "My Document",
    "content": "Document content",
    "category_code": "documents",
    "is_public": false
  }'
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
```bash
curl "http://localhost:8000/resources?category_code=documents" \
  -H "Authorization: Bearer YOUR_TOKEN"
```

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```
project_root/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ api/              # API endpoints
‚îÇ   ‚îú‚îÄ‚îÄ core/             # –Ø–¥—Ä–æ (security, dependencies, DTOs)
‚îÇ   ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ /services/    # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ database/         # –ë–î –∏ –º–æ–¥–µ–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ config.py         # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ main.py           # –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª
‚îú‚îÄ‚îÄ .env                  # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ requirements.txt      # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îî‚îÄ‚îÄ README.md             # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```
